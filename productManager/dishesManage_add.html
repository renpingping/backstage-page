<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- <%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%
	String path = request.getContextPath();
	String basePath = request.getScheme()+"://"+request.getServerName()+":"+request.getServerPort()+path+"/";
%>
<%
	pageContext.setAttribute("PATH", request.getContextPath());
%>  -->
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title></title>
	<meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <link rel="stylesheet" href="../layui/css/layui.css" media="all">
	<link rel="stylesheet" href="../css/store.css" media="all">
	<link rel="stylesheet" href="../css/donationOrder.css" media="all">
		<style>
			.layui-btn-xs{
				margin: 5px!important;
				margin-right: 5px!important;
			}
			table th,table td{
				text-align: center!important;
			}
			.hidediv{
				display: none;
			}
		</style>
</head>
<body>
	<!-- 添加菜品详情 start -->
	<div id="addDashes_content" style="margin:20px">
		<div class="layui-form">
			<div class="layui-form-item">
			  <div class="layui-col-md6 layui-col-sm6">
					<label class="layui-form-label">名称</label>
			    <div class="layui-input-block">
			      <input type="text" class="layui-input" id="dishesName" placeholder="请输入名称">
			    </div>
			  </div>
		    <div class="layui-col-md6 layui-col-sm6">
					<label class="layui-form-label">分类</label>
			    <div class="layui-input-block">
						<select class="select_modify" name="type" id="type">
			        <option value="">请选择分类</option>
			        <option value="0">在线预约</option>
			        <option value="1">线下预约</option>
		      	</select>
			    </div>
			  </div>
			</div>
			<div class="layui-form-item">
			  <div class="layui-col-md6 layui-col-sm6">
					<label class="layui-form-label">配图</label>
				    <div class="layui-input-block">
				      <button type="button" class="layui-btn" id="logoBtn">
							  <i class="layui-icon">&#xe67c;</i>上传配图
							</button>
							<button type="button" class="layui-btn layui-btn-warm" id="logoupload">开始上传</button>
				    </div>
				    <div class="layui-input-block">
				      <span>尺寸要求：a×b</span>
				    </div>
			  </div>
			  <div class="layui-col-md6 layui-col-sm6">
				    <label class="layui-form-label">组图</label>
				    <div class="layui-input-block">
				      	<div class="box1">
							    <div class="controls need-img">
							        <button type="button" class="layui-btn layui-btn-primary" id="upload_img_icon">上传图片</button>
							        <div class="upload-img-box">
							        </div>
							    </div>
								</div>
				    </div>
				    <div class="layui-input-block">
				      <span>尺寸要求：a×b</span>
				    </div>
			  </div>
			</div>
			<div class="layui-form-item">
			  <div class="layui-col-md6 layui-col-sm6">
					<label class="layui-form-label">烹饪方式</label>
					<div class="layui-input-block">
						<select class="select_modify" name="cookMethod" id="cookMethod">
			        <option value="">请选择烹饪方式</option>
			        <option value="0">煎</option>
			        <option value="1">炒</option>
			        <option value="2">烹</option>
			        <option value="3">炸</option>
		      	</select>
					</div>
			  </div>
			  <div class="layui-col-md6 layui-col-sm6">
					<label class="layui-form-label">耗时</label>
					<div class="layui-input-block">
			      <input type="text" class="layui-input" id="Hour" placeholder="0">
					</div>
			  </div>
			</div>
			<div class="layui-form-item">
			  <div class="layui-col-md6 layui-col-sm6">
					<label class="layui-form-label">香菜</label>
					<div class="layui-input-block">
				      <input type="radio" name="parsley" value="有" title="有" checked>
				      <input type="radio" name="parsley" value="无" title="无">
					</div>
			  </div>
			  <div class="layui-col-md6 layui-col-sm6">
					<label class="layui-form-label">蒜</label>
					<div class="layui-input-block">
				      <input type="radio" name="garlic" value="有" title="有" checked>
				      <input type="radio" name="garlic" value="无" title="无">
					</div>
			  </div>
			</div>
			<div class="layui-form-item">
			  <div class="layui-col-md6 layui-col-sm6">
					<label class="layui-form-label">辣度</label>
					<div class="layui-input-block">
						<select class="select_modify" name="spicy" id="spicy">
			        <option value="">请选择辣度</option>
			        <option value="0">一级</option>
			        <option value="1">二级</option>
			        <option value="2">三级</option>
		      	</select>
					</div>
			  </div>
			  <div class="layui-col-md6 layui-col-sm6">
					<label class="layui-form-label">原价</label>
					<div class="layui-input-block">
			      <input type="text" class="layui-input" id="Oriprice" placeholder="请输入原价">
					</div>
			  </div>
			</div>
			<div class="layui-form-item">
			  <div class="layui-col-md4 layui-col-sm4">
					<label class="layui-form-label">规格</label>
					<div class="layui-input-block">
				      <input type="radio" name="format"  lay-filter="format" value="有" title="有">
				      <input type="radio" name="format"  lay-filter="format" value="无" title="无" checked>
					</div>
			  </div>
			  <div class="layui-col-md8 layui-col-sm8">
				  <div class="oneformal">
						<label class="layui-form-label">价格表</label>
						<div class="layui-inline">
					    <input type="text" class="layui-input" id="format" placeholder="请输入规格">
					  </div>
						<div class="layui-inline"> 
					    <input type="text" class="layui-input" id="price" placeholder="请输入价格">
						</div>
				  </div>
				  <div class="threeformal hidediv">
						<label class="layui-form-label">价格表</label>
						<div class="layui-inline">
					    <input type="text" class="layui-input" id="format1" placeholder="请输入规格1"> 
					  </div>
						<div class="layui-inline"> 
					    <input type="text" class="layui-input" id="price1" placeholder="请输入价格1">
						</div>

						<label class="layui-form-label"></label>
						<div class="layui-inline">
					    <input type="text" class="layui-input" id="format2" placeholder="请输入规格2"> 
					  </div>
						<div class="layui-inline">  
					    <input type="text" class="layui-input" id="price2" placeholder="请输入价格2">
						</div>

						<label class="layui-form-label"></label>
						<div class="layui-inline">
					    <input type="text" class="layui-input" id="format3" placeholder="请输入规格3"> 
					  </div>
						<div class="layui-inline">  
					    <input type="text" class="layui-input" id="price3" placeholder="请输入价格3">
						</div>
				  </div>
			  </div>
			</div>
			<div class="layui-form-item">
			  <div class="layui-col-md6 layui-col-sm6">
					<label class="layui-form-label">简介</label>
					<div class="layui-input-block">
				      <textarea id="introduce" name="introduce" placeholder="请输入简介" class="layui-textarea"></textarea>
					</div>
			  </div>
			</div>
			<div class="layui-form-item" >
				<div class="layui-input-block">
					<input type="button" value="确定" onclick="modify()" class="layui-btn layui-btn-normal"/>
			    	<input type="button" value="取消" onclick="quit()" class="layui-btn"/>
				</div>
			</div>
		</div>
	</div><!-- 添加菜品详情 end -->
</body>
 	<script src="../js/jquery-3.3.1.js"></script>
	<script src="../layui/layui.js"></script>
	<script>
		layui.use(['element','jquery','form','table'], function(){
	  	var form = layui.form,table = layui.table;
	  	var element = layui.element,$=layui.jquery;
	  	form.on('radio(format)', function(data){  //点击规格有无
			  console.log(data.value);                //被点击的radio的value值
			  if(data.value == '有'){
			  	$('.oneformal').addClass('hidediv');
			  	$('.threeformal').removeClass('hidediv');
			  }else{
			  	$('.oneformal').removeClass('hidediv');
			  	$('.threeformal').addClass('hidediv');
			  }
			}); 
		});
	</script>
	<script>	
			//修改
		function modify(){					
			var dishesName = $.trim($('#dishesName').val());
			var type= $.trim($('#type').val());
			var Hour = $.trim($('#Hour').val());
			var cookMethod = $.trim($('#cookMethod').val());
			var spicyspicy = $.trim($('#spicy').val());
			var Oriprice = $.trim($('#Oriprice').val());													
			if( dishesName == ""||type==""|| Hour==""|| cookMethod=="" || spicy==""|| Oriprice==""){
	            alert("输入数据不能为空");
	             return;
	           }
	           	$.ajax({
	                url:'${PATH}/user/modifyUser.do',
	                type: 'post',
	                data: {'dishesName':dishesName,'type':type,'Hour':Hour,'cookMethod':cookMethod,'spicy':spicy,'Oriprice':Oriprice,'user_id':'${user.user_id}'},
	                dataType: 'JSON',
	                success: function(result){
	                    var field = result.state;
	                    if(field=='0'){
	                        alert(result.message);
	                        window.parent.location.reload();
	                        var index = parent.layer.getFrameIndex(window.name);
	                        parent.layer.close(index);
	                    }else{
	                        alert(result.message);
	                 		return;
	                 	}
	                }
	            });					
			}
		function quit(){
	        var index = parent.layer.getFrameIndex(window.name);
	        parent.layer.close(index);
	    }
	</script>
	<!-- 上传图片 -->
	<script type="text/javascript">
	 	layui.use('upload',function(){
	   	var upload = layui.upload;
	   	/*LOGO上传*/
	   	upload.render({
	      elem: '#logoBtn'
	      ,url: '../updatePersonalById.do'
	      ,accept: 'file'
	      ,auto: false
	      ,bindAction: '#logoupload'
	      ,done: function(res){
	          alert(res.data.src);
	          $("[name=userImage]").val(res.data.src);
	       }           
	    });
	   /*组图上传*/
	   	upload.render({
	      elem: '#fileBtn'
	      ,url: '../updatePersonalById.do'
	      ,accept: 'file'
	      ,auto: false
	      ,bindAction: '#uploadBtn'
	      ,done: function(res){
	        alert(res.data.src);
	        $("[name=userImage]").val(res.data.src);
	      }           
	    });
	 	});
	</script>
	<script>
	  var upurl = "{:url('xiaoguotu/upload')}"; //上传图片地址
	  layui.use(['layer','upload'], function(){
	      var layer = layui.layer;
	      var upload = layui.upload;
	      upload.render({ //上传图片
	          elem: '#upload_img_icon',
	          url: upurl,
	          multiple: true, //是否允许多文件上传。设置 true即可开启。不支持ie8/9
	          auto:true,//自动上传
	          before: function(obj) {
	              layer.msg('图片上传中...', {
	                  icon: 16,
	                  shade: 0.01,
	                  time: 0
	              })
	          },
	          done: function(res) {
	              layer.close(layer.msg('上传成功！'));
	              $('.upload-img-box').append('<dd class="upload-icon-img" ><div class="upload-pre-item"><i onclick="deleteImg($(this))"   class="layui-icon"></i><img src="' + res.data + '" class="img" ><input type="hidden" name="case_images[]" value="' + res.data + '" /></div></dd>');
	          }
	          ,error: function(){
	              layer.msg('上传错误！');
	          }
	      });

	  });
	  function deleteImg(obj){
	      //删除页面信息
	      obj.parent().parent('.upload-icon-img').remove();
	      //删除本地图片（ajax)
	      //删除数据库图片
	  }
	</script>	
</html>
